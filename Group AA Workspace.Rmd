---
title: "Group AA workspace"
output: pdf_document
date: '2022-10-03'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r hi}
hi <- "hi group!"
print(hi)
```

```{r importing demographic data}
#import CA Smoker data set
ca_smoker_info <- read_csv("~/PHW251_Fall2022/phw251_projectdata/ca_csc_smoker_data.csv")
ca_smoker_info

#tidying data
ca_smoker_selected <- ca_smoker_info %>% select(c(psraid,smokstat,HOWMANY, SMOK6NUM, SMOK6UNI)) %>% 
rename(ID = psraid, smoking_status = smokstat, howmany = HOWMANY, smok6num = SMOK6NUM, smok6uni = SMOK6UNI) %>%
mutate(pack_year = howmany)
ca_smoker_selected

#Hi this is Danni, for the calculation of pack-year, Im not quite sure which columns' data and which equation should I use. I just put the new column there and leave it with the value of "howmany", we can discuss more about it and I'll redo the pack-year column
```

```{r importing outcome data}
#import CA smoker disease outcome and race data set
ca_outcome_race <- read_csv("~/PHW251_Fall2022/phw251_projectdata/ca_csc_outcome_race_data.csv")

#tidying data
ca_outcome_race_selected <- ca_outcome_race %>% select(c(ID, SOCIAL, ASTHMA, HEARTDIS, DIABETES, OTHMENILL, INCOME, race01, race02, race03, race04, race05, race06, race07, race08, race09, race10, race11, race12, race13,race14, race15)) %>%
rename (social = SOCIAL, asthma = ASTHMA, heartdis = HEARTDIS, diabetes = DIABETES, othmenill = OTHMENILL, income = INCOME)
ca_outcome_race_selected
```

```{r}
#remove "DIS" & "STAT" in the "ID" column 
ca_outcome_race_selected$ID <- gsub("DIS","",as.character(ca_outcome_race_selected$ID))
ca_outcome_race_selected$ID <- gsub("STAT","",as.character(ca_outcome_race_selected$ID))
ca_outcome_race_selected

#joining two data sets by participant's unique ID
ca_smoker_outcome <- merge(x = ca_smoker_selected, y = ca_outcome_race_selected, by = "ID")
ca_smoker_outcome

#Hi this is Danni, here is all the columns we need in one table, (pls let me know if any column needed is not here :) Also, the race part seems unclear, maybe we can summarize it in one column that including 15 races. For now, we can leave it here and I'll try how to combine all 15 race columns in one column later)
```
```{r create single race variable}

#use mutate to combine 15 binary race columns into one categorical variable called "race"

ca_smoker_outcome <- ca_smoker_outcome %>% 
  mutate(race = case_when(race01 == "Yes" ~ "White",
                          race02 == "Yes" ~ "Black",
                          race03 == "Yes" ~ "Japanese",
                          race04 == "Yes" ~ "Chinese",
                          race05 == "Yes" ~ "Filipino",
                          race06 == "Yes" ~ "Korean",
                          race12 == "Yes" ~ "Vietnamese",
                          race07 == "Yes" ~ "OtherAPI",
                          race08 == "Yes" ~ "American Indian Alaska Native",
                          race09 == "Yes" ~ "Mexican",
                          race10 == "Yes" ~ "Hispanic or Latino",
                          race11 == "Yes" ~ "Other",
                          race13 == "Yes" ~ "Asian Indian",
                          race14 == "Yes" ~ "Refused",
                          race15 == "Yes" ~ "Don't Know"))

#drop leftover binary race columns

ca_smoker_outcome <- select(ca_smoker_outcome,-race01,
                                 -race02,
                                 -race03,
                                 -race04,
                                 -race05,
                                 -race06,
                                 -race07,
                                 -race08,
                                 -race09,
                                 -race10,
                                 -race11,
                                 -race12,
                                 -race13,
                                 -race14,
                                 -race15)
                            
```

